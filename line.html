<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Javascript: Charting Libraries -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.js"></script>
    <script src="http://unpkg.com/dc@3/dc.js"></script>
    <link rel="stylesheet" href="http://unpkg.com/dc@3/dc.css" />

    <!-- Prism: used for code block display -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/prism.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-highlight/prism-line-highlight.css" />
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-highlight/prism-line-highlight.js"></script>

    <!-- Twitter Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Custom CSS and JS -->
    <link rel="stylesheet" href="static/css/custom.css">

    <title>bglynch dc.js</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <h1 id="header-title">BGLYNCH Sample Chart's</h1><br>
        </div>
    </nav>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">Chart Type: </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item ">
                        <a class="nav-link" href="./index.html">Pie</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="./line.html">Line<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./bar.html">Bar</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div id="main" class="container">

        <!---->
        <h2>LINE CHARTS</h2>
        <hr />
        <section>
            <h3 class="mt-1">Our Data</h3>
            <p class="mb-0">Sample of data from our .csv file</p>
            <div class="row mt-05">
                <div class="col-xs-12 col-sm-12 text-center">
                    <pre><strong>id, name,       gender,     DOB,            MaritalStatus,  CreditCardType</strong><code class="language-javascript indentFix">
                            1,  Damaris,    Female,     1973-02-18,     false,          visa-electron
                            2,  Barbe,      Female,     1969-04-10,     true,           americanexpress
                            3,  Belia,      Female,     1960-04-16,     false,          maestro
                            4,  Leoline,    Female,     1995-01-19,     true,           bankcard
                            5,  Valentine,  Female,     1992-04-16,     false,      
                            6,  Rosanne,    Female,     1985-01-05,     true,           bankcard
                            7,  Shalna,     Female,     1956-11-01,     false,          jcb
                            8,  Mordy,      Male,       1990-03-27,     true,           china-unionpay
                            9,  Tristan,    Male,       1998-10-05,     true,       
                            10, Alphonso,   Male,       1992-08-10,     false,          mastercard
                    </code></pre>
                </div>
            </div>

            <h3 class="mt-4">Modify the Data</h3>
            <p class="mb-0">
                CSV data is loaded using "d3.csv". <br>
                Update the CreditCardType column so there is not blanks.<br>
                Create the crossfilter data set
            </p>
            <div class="row">
                <div class="col-xs-12 col-sm-12 text-center">
                    <pre><code class="language-javascript indentFix">
                        d3.csv("data/people.csv", function (errors, peopleData) {

                            peopleData.forEach(function (d) {
                                if (d.CreditCardType == "") {
                                    d.CreditCardType = "no data"
                                }
                            });
                            var ndx = crossfilter(peopleData);

                            ...
                        }</code></pre>
                </div>
                <div class="col-xs-12 col-sm-12 text-center">
                    <pre><strong>id, name,       gender,     DOB,            MaritalStatus,  CreditCardType</strong><code class="language-javascript indentFix">
                                1,  Damaris,    Female,     1973-02-18,     false,          visa-electron
                                2,  Barbe,      Female,     1969-04-10,     true,           americanexpress
                                3,  Belia,      Female,     1960-04-16,     false,          maestro
                                4,  Leoline,    Female,     1995-01-19,     true,           bankcard
                                5,  Valentine,  Female,     1992-04-16,     false,          no data
                                6,  Rosanne,    Female,     1985-01-05,     true,           bankcard
                                7,  Shalna,     Female,     1956-11-01,     false,          jcb
                                8,  Mordy,      Male,       1990-03-27,     true,           china-unionpay
                                9,  Tristan,    Male,       1998-10-05,     true,           no data
                                10, Alphonso,   Male,       1992-08-10,     false,          mastercard
                        </code></pre>
                </div>
            </div>

        </section>
        <section>
                <h3 class="mt-4">Display the Data</h3>

            <div class="row">
                <div class="col-xs-12 col-sm-2 text-center">
                    <div id="bar01" class="custom-chart"></div>
                    <pre data-line="11"><code class="language-javascript indentFix">
                        barChart01
                            .dimension(genderDimension)
                            .group(genderGroup)
                            .width($(barChart01.anchor()).parent().width())
                            .height(300)
                            .x(d3.scaleBand())
                            .xUnits(dc.units.ordinal);
                    </code></pre>
                </div>
                <div class="col-xs-12 col-sm-5 text-center">
                    <div id="line01" class="custom-chart"></div>
                    <pre><code class="language-javascript indentFix">
                                dc.lineChart('#line01')
                                    .dimension(ageDimension)
                                    .group(ageGroup)
                                    .width(650)
                                    .height(300)
                                    .x(d3.scaleLinear().domain([15, 70]))
                                    .xUnits(d3.timeDays)
                                    .brushOn(true)
                                    .yAxisLabel("Count")
                                    .xAxisLabel("Age");
                    </code></pre>
                </div>
                <div class="col-xs-12 col-sm-5 text-center">
                    <div id="line02" class="custom-chart"></div>
                    <pre data-line="11,12,13"><code class="language-javascript indentFix" >
                                dc.lineChart('#line02')
                                    .dimension(ageDimension)
                                    .group(ageGroup)
                                    .width(650)
                                    .height(300)
                                    .x(d3.scaleLinear().domain([15, 70]))
                                    .brushOn(false)
                                    .yAxisLabel("Count")
                                    .xAxisLabel("Age")
                                    .dashStyle([12, 4, 4, 4])
                                    .renderHorizontalGridLines(true)
                                    .renderVerticalGridLines(true);
                    </code></pre>
                </div>
            </div>

            <div class="row mt-5">
                <div class="col-xs-12 col-sm-6 text-center">
                    <div id="line03" class="custom-chart"></div>
                    <pre data-line="11,12"><code class="language-javascript indentFix">
                                dc.lineChart('#line03')
                                    .dimension(ageDimension)
                                    .group(ageGroup)
                                    .width(650)
                                    .height(300)
                                    .x(d3.scaleLinear().domain([15, 70]))
                                    .brushOn(false)
                                    .yAxisLabel("Count")
                                    .xAxisLabel("Age")
                                    .dotRadius(20)
                                    .renderArea(true);
                            </code></pre>
                </div>
                <div class="col-xs-12 col-sm-6 text-center">
                    <div id="line04" class="custom-chart"></div>
                    <pre data-line="11,12"><code class="language-javascript indentFix" >
                                dc.lineChart('#line04')
                                    .dimension(ageDimension)
                                    .group(ageGroup)
                                    .width(650)
                                    .height(300)
                                    .x(d3.scaleLinear().domain([15, 70]))
                                    .brushOn(false)
                                    .yAxisLabel("Count")
                                    .xAxisLabel("Age")
                                    .renderArea(true)
                                    .renderDataPoints({ radius: 3, fillOpacity: 0.8, strokeOpacity: 0.0 });
                            </code></pre>
                </div>
            </div>

            <div class="row">


            </div>
        </section>

    </div>

    <!-- Optional JavaScript for Bootstrap -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script>
        var toFix = document.getElementsByClassName("indentFix");
        for (var elem = 0, elems = toFix.length; elem < elems; elem++) {
            var lines = toFix[elem].innerHTML.split("\n");
            var line = lines[1];
            var leadingSpaces = 1;
            while (line.charAt(leadingSpaces) == " ") { leadingSpaces++; }
            for (var i = 1, len = lines.length; i < len; i++) {
                lines[i] = lines[i].slice(leadingSpaces);
            }
            toFix[elem].innerHTML = lines.join("\n");
        }
    </script>

    <script language="javascript">
        /* global dc, crossfilter, d3 */


        d3.csv("data/people.csv", function (errors, peopleData) {

            peopleData.forEach(function (d) {
                if (d.CreditCardType == "") {
                    d.CreditCardType = "no data"
                }
            });
            var ndx = crossfilter(peopleData);



            var ageDimension = ndx.dimension(function (data) {
                return ~~((Date.now() - new Date(data.DOB)) / (31557600000));
            });
            var ageGroup = ageDimension.group().reduceCount();

            var genderDimension = ndx.dimension(function (data) { return data.gender; });
            var genderGroup = genderDimension.group().reduceCount();


            var pieDim = ndx.dimension(function (data) {
                let age = ~~((Date.now() - new Date(data.DOB)) / (31557600000));
                if (age >= 50) {
                    return "Old";
                }
                else if (age > 30) {
                    return "Middle";
                }
                else {
                    return "Young";
                }
            });
            var pieGroup = pieDim.group();

            // instanciate the charts
            var barChart01 = dc.barChart('#bar01'),
                lineChart01 = dc.lineChart('#line01'),
                lineChart02 = dc.lineChart('#line02'),
                lineChart03 = dc.lineChart('#line03'),
                lineChart04 = dc.lineChart('#line04');

            // design the chart
            barChart01
                .dimension(genderDimension)
                .group(genderGroup)
                .width($(barChart01.anchor()).parent().width())
                .height(300)
                .x(d3.scaleBand())
                .xUnits(dc.units.ordinal);

            lineChart01
                .dimension(ageDimension)
                .group(ageGroup)
                .width($(lineChart01.anchor()).parent().width())
                .height(300)
                .x(d3.scaleLinear().domain([15, 70]))
                .brushOn(true)
                .yAxisLabel("Count")
                .xAxisLabel("Age");

            lineChart02
                .dimension(ageDimension)
                .group(ageGroup)
                .width($(lineChart02.anchor()).parent().width())
                .height(300)
                .x(d3.scaleLinear().domain([15, 70]))
                .brushOn(false)
                .curve(d3.curveLinear)
                .yAxisLabel("Count")
                .xAxisLabel("Age")
                .dashStyle([12, 4, 4, 4])
                .renderHorizontalGridLines(true)
                .renderVerticalGridLines(true)
                .elasticY(true);


            lineChart03
                .dimension(ageDimension)
                .group(ageGroup)
                .width($(lineChart03.anchor()).parent().width())
                .height(300)
                .x(d3.scaleLinear().domain([15, 70]))
                .brushOn(false)
                .yAxisLabel("Count")
                .xAxisLabel("Age")
                .dotRadius(20)
                .renderArea(true);

            lineChart04
                .dimension(ageDimension)
                .group(ageGroup)
                .width($(lineChart04.anchor()).parent().width())
                .height(300)
                .x(d3.scaleLinear().domain([15, 70]))
                .brushOn(false)
                .yAxisLabel("Count")
                .xAxisLabel("Age")
                .renderArea(true)
                .renderDataPoints({ radius: 3, fillOpacity: 0.8, strokeOpacity: 0.0 });


            dc.renderAll();
        });

    </script>
</body>

</html>